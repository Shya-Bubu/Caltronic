{
    "visuals": [
        {
            "id": "unbiased-bjt-circuit",
            "type": "plotly",
            "title": "Unbiased BJT Common-Emitter Circuit",
            "description": "A sinusoidal source v_in connected through R_B to the base of an NPN transistor. No DC bias — the transistor relies entirely on the input signal.",
            "traces": [
                {
                    "x": [
                        "v_in",
                        "R_B",
                        "BJT Q₁",
                        "R_C",
                        "V_CC"
                    ],
                    "y": [
                        1,
                        1,
                        1,
                        1,
                        1
                    ],
                    "type": "bar",
                    "marker": {
                        "color": [
                            "#4f8cff",
                            "#6b62ff",
                            "#2fbf8f",
                            "#6b62ff",
                            "#ff6b8a"
                        ]
                    },
                    "text": [
                        "Signal\n(sinusoid)",
                        "Base\nResistor",
                        "NPN\nTransistor",
                        "Collector\nLoad",
                        "+V_CC\nSupply"
                    ],
                    "textposition": "inside",
                    "textfont": {
                        "size": 13,
                        "color": "#ffffff"
                    },
                    "showlegend": false,
                    "hoverinfo": "none"
                }
            ],
            "layout": {
                "xaxis": {
                    "title": "Signal Path (left to right)"
                },
                "yaxis": {
                    "visible": false,
                    "range": [
                        0,
                        1.3
                    ]
                },
                "showlegend": false,
                "annotations": [
                    {
                        "x": "BJT Q₁",
                        "y": 1.15,
                        "text": "No DC bias → signal clipped!",
                        "showarrow": false,
                        "font": {
                            "size": 14,
                            "color": "#ff6b8a"
                        }
                    }
                ]
            },
            "height": 300
        },
        {
            "id": "signal-clipping-waveform",
            "type": "plotly",
            "title": "Input vs Output: Signal Clipping Without Bias",
            "description": "The input sinusoid swings ±1 V. When v_in < 0.7 V the BJT cuts off → v_out = V_CC. Only peaks above 0.7 V produce output.",
            "traces": [
                {
                    "x_expr": "Array.from({length: 400}, (_, i) => i * 2 * Math.PI / 400)",
                    "y_expr": "Array.from({length: 400}, (_, i) => Math.sin(i * 2 * Math.PI / 400))",
                    "mode": "lines",
                    "name": "Input v_in (1 V peak)",
                    "line": {
                        "color": "#4f8cff",
                        "width": 2
                    }
                },
                {
                    "x_expr": "Array.from({length: 400}, (_, i) => i * 2 * Math.PI / 400)",
                    "y_expr": "Array.from({length: 400}, (_, i) => { const vin = Math.sin(i * 2 * Math.PI / 400); if(vin < 0.7) return 10; return 10 - 50 * 10 / 100 * (vin - 0.7); })",
                    "mode": "lines",
                    "name": "Output v_out (clipped!)",
                    "line": {
                        "color": "#ff6b8a",
                        "width": 2.5
                    },
                    "yaxis": "y2"
                }
            ],
            "layout": {
                "xaxis": {
                    "title": "Time (rad)"
                },
                "yaxis": {
                    "title": "v_in (V)",
                    "side": "left"
                },
                "yaxis2": {
                    "title": "v_out (V)",
                    "side": "right",
                    "overlaying": "y"
                },
                "showlegend": true
            }
        },
        {
            "id": "bjt-regions-map",
            "type": "plotly",
            "title": "BJT Operating Regions — Where Should the Q-Point Be?",
            "description": "Three operating regions. Biasing places the Q-point in the ACTIVE region so the signal can swing without hitting cutoff or saturation.",
            "traces": [
                {
                    "x": [
                        "CUTOFF",
                        "ACTIVE LINEAR",
                        "SATURATION"
                    ],
                    "y": [
                        1,
                        1,
                        1
                    ],
                    "type": "bar",
                    "marker": {
                        "color": [
                            "#ff6b8a",
                            "#2fbf8f",
                            "#f5a623"
                        ]
                    },
                    "text": [
                        "I_C ≈ 0<br>V_CE ≈ V_CC<br>Transistor OFF",
                        "I_C = βI_B<br>Amplification<br>Q-POINT HERE ✓",
                        "I_C < βI_B<br>V_CE ≈ 0.2V<br>Transistor fully ON"
                    ],
                    "textposition": "inside",
                    "textfont": {
                        "size": 12,
                        "color": "#ffffff"
                    },
                    "showlegend": false,
                    "hoverinfo": "none"
                }
            ],
            "layout": {
                "xaxis": {
                    "title": "Operating Region"
                },
                "yaxis": {
                    "visible": false,
                    "range": [
                        0,
                        1.3
                    ]
                },
                "showlegend": false,
                "annotations": [
                    {
                        "x": "CUTOFF",
                        "y": 1.15,
                        "text": "V_BE < 0.7V →",
                        "showarrow": false,
                        "font": {
                            "size": 11,
                            "color": "#aab4c0"
                        }
                    },
                    {
                        "x": "SATURATION",
                        "y": 1.15,
                        "text": "← V_CE < V_CE(sat)",
                        "showarrow": false,
                        "font": {
                            "size": 11,
                            "color": "#aab4c0"
                        }
                    }
                ]
            },
            "height": 300
        },
        {
            "id": "biasing-solution-diagram",
            "type": "plotly",
            "title": "The Solution: DC Bias + AC Signal → Full Amplification",
            "description": "Add a fixed DC voltage at the base so the transistor stays active. The signal rides on top of the DC bias.",
            "traces": [
                {
                    "x": [
                        "DC Bias<br>(from V_CC)",
                        "AC Signal<br>(through C_in)",
                        "V_BE =<br>DC + AC",
                        "Undistorted<br>Output"
                    ],
                    "y": [
                        1,
                        1,
                        1,
                        1
                    ],
                    "type": "bar",
                    "marker": {
                        "color": [
                            "#f5a623",
                            "#4f8cff",
                            "#6b62ff",
                            "#2fbf8f"
                        ]
                    },
                    "text": [
                        "From biasing<br>resistors",
                        "v_in through<br>coupling cap",
                        "V_BEQ + v_be<br>always > 0.7V",
                        "Full signal<br>amplified ✓"
                    ],
                    "textposition": "inside",
                    "textfont": {
                        "size": 12,
                        "color": "#ffffff"
                    },
                    "showlegend": false,
                    "hoverinfo": "none"
                }
            ],
            "layout": {
                "xaxis": {
                    "title": "Signal Flow"
                },
                "yaxis": {
                    "visible": false,
                    "range": [
                        0,
                        1.3
                    ]
                },
                "showlegend": false
            },
            "height": 280
        },
        {
            "id": "biased-output-waveform",
            "type": "plotly",
            "title": "With Proper Bias: Full Signal Amplified",
            "description": "DC bias keeps V_BE well above 0.7 V. The output is a clean, amplified, inverted sinusoid with no clipping.",
            "traces": [
                {
                    "x_expr": "Array.from({length: 400}, (_, i) => i * 2 * Math.PI / 400)",
                    "y_expr": "Array.from({length: 400}, (_, i) => 0.012 * Math.sin(i * 2 * Math.PI / 400))",
                    "mode": "lines",
                    "name": "Input v_in (12 mV peak)",
                    "line": {
                        "color": "#4f8cff",
                        "width": 2
                    }
                },
                {
                    "x_expr": "Array.from({length: 400}, (_, i) => i * 2 * Math.PI / 400)",
                    "y_expr": "Array.from({length: 400}, (_, i) => 5 - 100 * 0.012 * Math.sin(i * 2 * Math.PI / 400))",
                    "mode": "lines",
                    "name": "Output v_out (amplified, inverted)",
                    "line": {
                        "color": "#2fbf8f",
                        "width": 2.5
                    },
                    "yaxis": "y2"
                }
            ],
            "layout": {
                "xaxis": {
                    "title": "Time (rad)"
                },
                "yaxis": {
                    "title": "v_in (V)",
                    "side": "left"
                },
                "yaxis2": {
                    "title": "v_out (V)",
                    "side": "right",
                    "overlaying": "y"
                },
                "showlegend": true
            }
        },
        {
            "id": "qpoint-on-characteristics",
            "type": "plotly",
            "title": "Q-Point on the Output Characteristics",
            "description": "The Q-point sits in the middle of the active region on the I_C vs V_CE characteristics.",
            "traces": [
                {
                    "x_expr": "Array.from({length: 100}, (_, i) => i * 0.12)",
                    "y_expr": "Array.from({length: 100}, (_, i) => { const v = i * 0.12; if(v < 0.2) return 50e-6 * 200 * v / 0.2; return 50e-6 * 200; })",
                    "mode": "lines",
                    "name": "I_B = 50 μA",
                    "line": {
                        "color": "#aab4c0",
                        "width": 1.5
                    }
                },
                {
                    "x_expr": "Array.from({length: 100}, (_, i) => i * 0.12)",
                    "y_expr": "Array.from({length: 100}, (_, i) => { const v = i * 0.12; if(v < 0.2) return 30e-6 * 200 * v / 0.2; return 30e-6 * 200; })",
                    "mode": "lines",
                    "name": "I_B = 30 μA",
                    "line": {
                        "color": "#aab4c0",
                        "width": 1.5
                    }
                },
                {
                    "x": [
                        5
                    ],
                    "y": [
                        0.006
                    ],
                    "mode": "markers",
                    "name": "Q-point",
                    "marker": {
                        "size": 14,
                        "color": "#ff6b8a",
                        "symbol": "star"
                    }
                }
            ],
            "layout": {
                "xaxis": {
                    "title": "V_CE (V)",
                    "range": [
                        0,
                        12
                    ]
                },
                "yaxis": {
                    "title": "I_C (A)"
                },
                "showlegend": true
            }
        },
        {
            "id": "notation-table",
            "type": "plotly",
            "title": "Signal Notation Convention",
            "description": "Four styles: Capital+Capital = DC, lower+lower = AC, lower+Capital = total, Capital+lower = phasor/RMS.",
            "traces": [
                {
                    "x": [
                        "DC Only<br>I_C, V_CE",
                        "AC Only<br>i_c, v_ce",
                        "Total (DC+AC)<br>i_C, v_CE",
                        "Phasor/RMS<br>I_c, V_ce"
                    ],
                    "y": [
                        1,
                        1,
                        1,
                        1
                    ],
                    "type": "bar",
                    "marker": {
                        "color": [
                            "#4f8cff",
                            "#ff6b8a",
                            "#2fbf8f",
                            "#f5a623"
                        ]
                    },
                    "text": [
                        "Capital letter<br>Capital subscript",
                        "Lowercase letter<br>Lowercase subscript",
                        "Lowercase letter<br>Capital subscript",
                        "Capital letter<br>Lowercase subscript"
                    ],
                    "textposition": "inside",
                    "textfont": {
                        "size": 11,
                        "color": "#ffffff"
                    },
                    "showlegend": false,
                    "hoverinfo": "none"
                }
            ],
            "layout": {
                "xaxis": {
                    "title": "Notation Type"
                },
                "yaxis": {
                    "visible": false,
                    "range": [
                        0,
                        1.3
                    ]
                },
                "showlegend": false
            },
            "height": 300
        },
        {
            "id": "dc-ac-superposition",
            "type": "plotly",
            "title": "DC + AC = Total Signal at the Base",
            "description": "Total V_BE = DC bias (0.7 V) + small AC signal. The DC keeps the transistor on; the AC gets amplified.",
            "traces": [
                {
                    "x_expr": "Array.from({length: 400}, (_, i) => i / 400 * 4 * Math.PI)",
                    "y_expr": "Array.from({length: 400}, () => 0.7)",
                    "mode": "lines",
                    "name": "DC bias V_BEQ = 0.7 V",
                    "line": {
                        "color": "#f5a623",
                        "width": 2,
                        "dash": "dash"
                    }
                },
                {
                    "x_expr": "Array.from({length: 400}, (_, i) => i / 400 * 4 * Math.PI)",
                    "y_expr": "Array.from({length: 400}, (_, i) => 0.012 * Math.sin(i / 400 * 4 * Math.PI))",
                    "mode": "lines",
                    "name": "AC signal v_be (12 mV)",
                    "line": {
                        "color": "#4f8cff",
                        "width": 1.5
                    }
                },
                {
                    "x_expr": "Array.from({length: 400}, (_, i) => i / 400 * 4 * Math.PI)",
                    "y_expr": "Array.from({length: 400}, (_, i) => 0.7 + 0.012 * Math.sin(i / 400 * 4 * Math.PI))",
                    "mode": "lines",
                    "name": "Total v_BE = V_BEQ + v_be",
                    "line": {
                        "color": "#2fbf8f",
                        "width": 2.5
                    }
                }
            ],
            "layout": {
                "xaxis": {
                    "title": "Time"
                },
                "yaxis": {
                    "title": "v_BE (V)",
                    "range": [
                        0.65,
                        0.75
                    ]
                },
                "showlegend": true
            }
        },
        {
            "id": "clipping-explorer-sim",
            "type": "v3-waveform",
            "title": "Interactive: Explore Signal Clipping vs Bias Level",
            "description": "Adjust the waveform parameters to see how bias level affects signal clipping."
        },
        {
            "id": "coupling-capacitor-diagram",
            "type": "plotly",
            "title": "Coupling Capacitor: Blocking DC, Passing AC",
            "description": "C_in blocks DC (X_C = ∞ at ω = 0) and passes AC (X_C ≈ 0 at signal frequencies), protecting the DC bias.",
            "traces": [
                {
                    "x": [
                        "Signal Source<br>(AC + DC)",
                        "C_in<br>Coupling Cap",
                        "BJT Base<br>(AC only)"
                    ],
                    "y": [
                        1,
                        1,
                        1
                    ],
                    "type": "bar",
                    "marker": {
                        "color": [
                            "#4f8cff",
                            "#f5a623",
                            "#2fbf8f"
                        ]
                    },
                    "text": [
                        "v_s contains<br>both DC and AC",
                        "Blocks DC ✗<br>Passes AC ✓",
                        "Receives pure AC<br>DC bias undisturbed"
                    ],
                    "textposition": "inside",
                    "textfont": {
                        "size": 12,
                        "color": "#ffffff"
                    },
                    "showlegend": false,
                    "hoverinfo": "none"
                }
            ],
            "layout": {
                "xaxis": {
                    "title": "Signal Path"
                },
                "yaxis": {
                    "visible": false,
                    "range": [
                        0,
                        1.3
                    ]
                },
                "showlegend": false,
                "annotations": [
                    {
                        "x": "C_in<br>Coupling Cap",
                        "y": 1.15,
                        "text": "DC: X_C = ∞ (open) | AC: X_C ≈ 0 (short)",
                        "showarrow": false,
                        "font": {
                            "size": 11,
                            "color": "#aab4c0"
                        }
                    }
                ]
            },
            "height": 300
        }
    ]
}