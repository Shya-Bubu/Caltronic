{
    "conceptId": "differential-amplifier",
    "visuals": [
        {
            "id": "diag-intuition-01",
            "visualType": "diagram",
            "type": "d3-block-diagram",
            "placement": "intuition",
            "title": "Differential Amplifier Circuit",
            "description": "Two inputs through matched resistor networks. Output = Gain × (Vi2 − Vi1).",
            "blocks": [
                {
                    "id": "Vi1",
                    "label": "Vi1",
                    "x": 10,
                    "y": 30,
                    "type": "input"
                },
                {
                    "id": "R1",
                    "label": "R1 (2.2kΩ)",
                    "x": 80,
                    "y": 20,
                    "width": 90
                },
                {
                    "id": "opamp",
                    "label": "Op-Amp",
                    "x": 220,
                    "y": 40,
                    "width": 80,
                    "height": 70
                },
                {
                    "id": "R2",
                    "label": "R2 (39kΩ)",
                    "x": 220,
                    "y": 140,
                    "width": 90
                },
                {
                    "id": "Vi2",
                    "label": "Vi2",
                    "x": 10,
                    "y": 90,
                    "type": "input"
                },
                {
                    "id": "R3",
                    "label": "R3 (2.2kΩ)",
                    "x": 80,
                    "y": 80,
                    "width": 90
                },
                {
                    "id": "R4",
                    "label": "R4 (39kΩ)",
                    "x": 80,
                    "y": 140,
                    "width": 90
                },
                {
                    "id": "Vo",
                    "label": "Vo",
                    "x": 360,
                    "y": 65,
                    "type": "output"
                },
                {
                    "id": "gnd",
                    "label": "GND",
                    "x": 80,
                    "y": 200,
                    "type": "input"
                }
            ],
            "connections": [
                {
                    "from": "Vi1",
                    "to": "R1"
                },
                {
                    "from": "R1",
                    "to": "opamp",
                    "label": "−"
                },
                {
                    "from": "Vi2",
                    "to": "R3"
                },
                {
                    "from": "R3",
                    "to": "opamp",
                    "label": "+"
                },
                {
                    "from": "R3",
                    "to": "R4"
                },
                {
                    "from": "R4",
                    "to": "gnd"
                },
                {
                    "from": "opamp",
                    "to": "Vo"
                },
                {
                    "from": "opamp",
                    "to": "R2",
                    "label": "feedback"
                },
                {
                    "from": "R2",
                    "to": "R1"
                }
            ]
        },
        {
            "id": "sim-intuition-01",
            "visualType": "simulation",
            "type": "d3-simulation",
            "simulationType": "signal-generator",
            "placement": "intuition",
            "title": "Common-Mode Rejection Demo",
            "description": "Add the same noise to both inputs — see how it's rejected in the output!"
        },
        {
            "id": "diag-engineering-01",
            "visualType": "diagram",
            "type": "d3-block-diagram",
            "placement": "engineering",
            "title": "Activity 3: Measuring CMRR",
            "description": "Step 1: One input grounded to measure AD. Step 2: Same signal to both for Acm.",
            "blocks": [
                {
                    "id": "step1",
                    "label": "Step 1: AD",
                    "x": 10,
                    "y": 30,
                    "width": 100
                },
                {
                    "id": "measure1",
                    "label": "Vo/Vi2 (Vi1=0)",
                    "x": 150,
                    "y": 30,
                    "width": 120
                },
                {
                    "id": "step2",
                    "label": "Step 2: Acm",
                    "x": 10,
                    "y": 90,
                    "width": 100
                },
                {
                    "id": "measure2",
                    "label": "Vo/Vcm (same in)",
                    "x": 150,
                    "y": 90,
                    "width": 130
                }
            ],
            "connections": [
                {
                    "from": "step1",
                    "to": "measure1"
                },
                {
                    "from": "step2",
                    "to": "measure2"
                }
            ]
        },
        {
            "id": "diag-mathematics-01",
            "visualType": "diagram",
            "type": "d3-block-diagram",
            "placement": "mathematics",
            "title": "CMRR Definition",
            "description": "CMRR = AD / Acm. Higher CMRR = better noise rejection. 741 has ~70 dB CMRR.",
            "blocks": [
                {
                    "id": "formula",
                    "label": "CMRR = |AD/Acm|",
                    "x": 100,
                    "y": 40,
                    "width": 150
                },
                {
                    "id": "db",
                    "label": "CMRR_dB = 20log₁₀(CMRR)",
                    "x": 80,
                    "y": 100,
                    "width": 200
                }
            ],
            "connections": []
        }
    ]
}