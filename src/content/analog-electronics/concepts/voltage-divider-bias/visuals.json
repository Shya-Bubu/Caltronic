{
    "visuals": [
        {
            "id": "vdb-circuit-schematic",
            "type": "plotly",
            "title": "Voltage Divider Bias — Component Layout",
            "description": "R₁ and R₂ form a divider setting V_B. R_C is the collector load. R_E provides emitter stabilisation.",
            "traces": [
                {
                    "x": [
                        "R₁\n(to V_CC)",
                        "R₂\n(to GND)",
                        "NPN\nBJT",
                        "R_C\n(collector)",
                        "R_E\n(emitter)"
                    ],
                    "y": [
                        1,
                        1,
                        1,
                        1,
                        1
                    ],
                    "type": "bar",
                    "marker": {
                        "color": [
                            "#6b62ff",
                            "#6b62ff",
                            "#2fbf8f",
                            "#6b62ff",
                            "#f5a623"
                        ]
                    },
                    "text": [
                        "Sets V_B<br>(upper)",
                        "Sets V_B<br>(lower)",
                        "Active<br>region",
                        "Load<br>resistor",
                        "Stability<br>feedback"
                    ],
                    "textposition": "inside",
                    "textfont": {
                        "size": 11,
                        "color": "#ffffff"
                    },
                    "showlegend": false,
                    "hoverinfo": "none"
                }
            ],
            "layout": {
                "xaxis": {
                    "title": "Components"
                },
                "yaxis": {
                    "visible": false,
                    "range": [
                        0,
                        1.3
                    ]
                },
                "showlegend": false,
                "annotations": [
                    {
                        "x": "R_E\n(emitter)",
                        "y": 1.15,
                        "text": "KEY: R_E provides negative feedback!",
                        "showarrow": false,
                        "font": {
                            "size": 12,
                            "color": "#f5a623"
                        }
                    }
                ]
            },
            "height": 300
        },
        {
            "id": "thevenin-conversion",
            "type": "plotly",
            "title": "Thévenin Equivalent of the R₁-R₂ Divider",
            "description": "The divider simplifies to V_TH = R₂/(R₁+R₂)·V_CC in series with R_TH = R₁‖R₂.",
            "traces": [
                {
                    "x": [
                        "Original Bias:<br>R₁ to V_CC, R₂ to GND",
                        "→ Thévenin<br>Equivalent →",
                        "V_TH + R_TH<br>single source + resistor"
                    ],
                    "y": [
                        1,
                        1,
                        1
                    ],
                    "type": "bar",
                    "marker": {
                        "color": [
                            "#4f8cff",
                            "#f5a623",
                            "#2fbf8f"
                        ]
                    },
                    "text": [
                        "Two resistors<br>+ V_CC",
                        "Convert using<br>Thévenin theorem",
                        "V_TH = R₂V_CC/(R₁+R₂)<br>R_TH = R₁‖R₂"
                    ],
                    "textposition": "inside",
                    "textfont": {
                        "size": 10,
                        "color": "#ffffff"
                    },
                    "showlegend": false,
                    "hoverinfo": "none"
                }
            ],
            "layout": {
                "xaxis": {
                    "title": ""
                },
                "yaxis": {
                    "visible": false,
                    "range": [
                        0,
                        1.3
                    ]
                },
                "showlegend": false
            },
            "height": 280
        },
        {
            "id": "vdb-be-loop-kvl",
            "type": "plotly",
            "title": "KVL on the Base-Emitter Loop (Thévenin Form)",
            "description": "V_TH = I_B·R_TH + V_BE + I_E·R_E → I_B = (V_TH − 0.7)/[R_TH + (1+β)R_E]",
            "traces": [
                {
                    "x": [
                        "V_TH",
                        "I_B · R_TH",
                        "V_BE ≈ 0.7V",
                        "I_E · R_E<br>≈ (1+β)I_B·R_E"
                    ],
                    "y": [
                        5,
                        0.12,
                        0.7,
                        4.18
                    ],
                    "type": "bar",
                    "marker": {
                        "color": [
                            "#ff6b8a",
                            "#6b62ff",
                            "#2fbf8f",
                            "#f5a623"
                        ]
                    },
                    "showlegend": false,
                    "hoverinfo": "none"
                }
            ],
            "layout": {
                "xaxis": {
                    "title": "KVL Components"
                },
                "yaxis": {
                    "title": "Voltage (V)"
                },
                "showlegend": false,
                "annotations": [
                    {
                        "x": "I_E · R_E<br>≈ (1+β)I_B·R_E",
                        "y": 4.6,
                        "text": "This term dominates → β-independent!",
                        "showarrow": true,
                        "arrowhead": 2,
                        "font": {
                            "size": 11,
                            "color": "#f5a623"
                        }
                    }
                ]
            },
            "height": 350
        },
        {
            "id": "thermal-runaway-loop",
            "type": "plotly",
            "title": "Thermal Runaway: The Positive Feedback Loop (Without R_E)",
            "description": "T↑ → β↑ → I_C↑ → Power↑ → T↑ → RUNAWAY! No R_E means no counteracting force.",
            "traces": [
                {
                    "x": [
                        "Temp ↑",
                        "β ↑",
                        "I_C ↑",
                        "Power ↑",
                        "More Heat!"
                    ],
                    "y": [
                        1,
                        1,
                        1,
                        1,
                        1
                    ],
                    "type": "bar",
                    "marker": {
                        "color": [
                            "#ff6b8a",
                            "#f5a623",
                            "#6b62ff",
                            "#ff6b8a",
                            "#ff6b8a"
                        ]
                    },
                    "text": [
                        "Junction<br>heats up",
                        "β increases<br>with temp",
                        "I_C = βI_B<br>increases",
                        "P = I_C·V_CE<br>increases",
                        "Cycle<br>repeats! ↻"
                    ],
                    "textposition": "inside",
                    "textfont": {
                        "size": 10,
                        "color": "#ffffff"
                    },
                    "showlegend": false,
                    "hoverinfo": "none"
                }
            ],
            "layout": {
                "xaxis": {
                    "title": "Positive Feedback Loop → Thermal Runaway"
                },
                "yaxis": {
                    "visible": false,
                    "range": [
                        0,
                        1.3
                    ]
                },
                "showlegend": false,
                "annotations": [
                    {
                        "x": "More Heat!",
                        "y": 1.15,
                        "text": "⚠️ DANGER: Can destroy transistor!",
                        "showarrow": false,
                        "font": {
                            "size": 12,
                            "color": "#ff6b8a"
                        }
                    }
                ]
            },
            "height": 300
        },
        {
            "id": "negative-feedback-re",
            "type": "plotly",
            "title": "R_E Provides Negative Feedback → Self-Correction",
            "description": "T↑ → I_C↑ → V_E↑ → V_BE↓ → I_B↓ → I_C↓. The increase self-corrects!",
            "traces": [
                {
                    "x": [
                        "T↑ → β↑",
                        "I_C↑ → I_E↑",
                        "V_E = I_E·R_E ↑",
                        "V_BE = V_B−V_E ↓",
                        "I_B↓ → I_C↓"
                    ],
                    "y": [
                        1,
                        1,
                        1,
                        1,
                        1
                    ],
                    "type": "bar",
                    "marker": {
                        "color": [
                            "#ff6b8a",
                            "#f5a623",
                            "#6b62ff",
                            "#2fbf8f",
                            "#2fbf8f"
                        ]
                    },
                    "text": [
                        "Temp rises<br>β increases",
                        "Collector &<br>emitter ↑",
                        "Emitter voltage<br>rises",
                        "V_BE shrinks<br>(V_B fixed!)",
                        "Corrects!<br>I_C falls back"
                    ],
                    "textposition": "inside",
                    "textfont": {
                        "size": 10,
                        "color": "#ffffff"
                    },
                    "showlegend": false,
                    "hoverinfo": "none"
                }
            ],
            "layout": {
                "xaxis": {
                    "title": "Negative Feedback Loop → Stability ✓"
                },
                "yaxis": {
                    "visible": false,
                    "range": [
                        0,
                        1.3
                    ]
                },
                "showlegend": false,
                "annotations": [
                    {
                        "x": "I_B↓ → I_C↓",
                        "y": 1.15,
                        "text": "✓ Self-correcting — no runaway!",
                        "showarrow": false,
                        "font": {
                            "size": 12,
                            "color": "#2fbf8f"
                        }
                    }
                ]
            },
            "height": 300
        },
        {
            "id": "stability-comparison-plot",
            "type": "plotly",
            "title": "Q-Point Stability: Fixed Bias vs Voltage Divider Bias",
            "description": "Fixed bias: I_C grows linearly with β. VDB with R_E: I_C is nearly flat — massive improvement.",
            "traces": [
                {
                    "x_expr": "Array.from({length: 200}, (_, i) => 50 + i)",
                    "y_expr": "Array.from({length: 200}, (_, i) => (50 + i) * 20e-6 * 1000)",
                    "mode": "lines",
                    "name": "Fixed bias (I_C = β × 20μA)",
                    "line": {
                        "color": "#ff6b8a",
                        "width": 2.5
                    }
                },
                {
                    "x_expr": "Array.from({length: 200}, (_, i) => 50 + i)",
                    "y_expr": "Array.from({length: 200}, (_, i) => { const b = 50 + i; const ib = 4.3 / (28 + (1+b) * 1); return b * ib; })",
                    "mode": "lines",
                    "name": "VDB with R_E (nearly constant)",
                    "line": {
                        "color": "#2fbf8f",
                        "width": 2.5
                    }
                }
            ],
            "layout": {
                "xaxis": {
                    "title": "β"
                },
                "yaxis": {
                    "title": "I_CQ (mA)"
                },
                "showlegend": true
            }
        },
        {
            "id": "vdb-worked-example",
            "type": "plotly",
            "title": "Worked Example: V_CC=10V, R₁=R₂=56kΩ, R_C=10kΩ, R_E=20kΩ, β=50",
            "description": "V_TH = 5V, R_TH = 28kΩ. I_B ≈ 4.1μA, I_C ≈ 205μA, V_CE ≈ 3.85V.",
            "traces": [
                {
                    "x": [
                        "Thévenin",
                        "I_B",
                        "I_C",
                        "V_CE"
                    ],
                    "y": [
                        1,
                        1,
                        1,
                        1
                    ],
                    "type": "bar",
                    "marker": {
                        "color": [
                            "#6b62ff",
                            "#2fbf8f",
                            "#f5a623",
                            "#ff6b8a"
                        ]
                    },
                    "text": [
                        "V_TH = 5V<br>R_TH = 28kΩ",
                        "(5−0.7)/(28k+1020k)<br>≈ 4.1 μA",
                        "50 × 4.1μA<br>≈ 205 μA",
                        "10−205μ×30k<br>≈ 3.85V"
                    ],
                    "textposition": "inside",
                    "textfont": {
                        "size": 10,
                        "color": "#ffffff"
                    },
                    "showlegend": false,
                    "hoverinfo": "none"
                }
            ],
            "layout": {
                "xaxis": {
                    "title": ""
                },
                "yaxis": {
                    "visible": false,
                    "range": [
                        0,
                        1.3
                    ]
                },
                "showlegend": false
            },
            "height": 280
        },
        {
            "id": "vdb-design-sim",
            "type": "v3-load-line",
            "title": "Interactive: Tune Resistors and Watch the Q-Point",
            "description": "Adjust resistor values and β. Compare Q-point stability between fixed and voltage divider bias."
        },
        {
            "id": "re-tradeoff-plot",
            "type": "plotly",
            "title": "R_E Trade-off: Stability vs Voltage Headroom",
            "description": "Larger R_E → better stability but less V_CE for signal swing.",
            "traces": [
                {
                    "x_expr": "Array.from({length: 100}, (_, i) => 0.1 + i * 0.05)",
                    "y_expr": "Array.from({length: 100}, (_, i) => { const re = 0.1 + i * 0.05; return re / (28 + 51 * re) * 100; })",
                    "mode": "lines",
                    "name": "Stability factor (%)",
                    "line": {
                        "color": "#2fbf8f",
                        "width": 2.5
                    }
                },
                {
                    "x_expr": "Array.from({length: 100}, (_, i) => 0.1 + i * 0.05)",
                    "y_expr": "Array.from({length: 100}, (_, i) => { const re = 0.1 + i * 0.05; const ib = 4.3 / (28 + 51 * re); const ic = 50 * ib; return 10 - ic * (10 + re); })",
                    "mode": "lines",
                    "name": "V_CE available (V)",
                    "line": {
                        "color": "#ff6b8a",
                        "width": 2.5
                    }
                }
            ],
            "layout": {
                "xaxis": {
                    "title": "R_E (kΩ)"
                },
                "yaxis": {
                    "title": "Value"
                },
                "showlegend": true
            }
        },
        {
            "id": "vdb-vs-fixed-summary",
            "type": "plotly",
            "title": "Fixed Bias vs Voltage Divider Bias — Comparison",
            "description": "Fixed bias: simple but β-sensitive. VDB: more components but industry standard with excellent stability.",
            "traces": [
                {
                    "x": [
                        "Simplicity",
                        "Calculation",
                        "β Sensitivity",
                        "Thermal Stability",
                        "Practical Use"
                    ],
                    "y": [
                        5,
                        5,
                        1,
                        1,
                        1
                    ],
                    "name": "Fixed Bias",
                    "type": "bar",
                    "marker": {
                        "color": "#ff6b8a"
                    }
                },
                {
                    "x": [
                        "Simplicity",
                        "Calculation",
                        "β Sensitivity",
                        "Thermal Stability",
                        "Practical Use"
                    ],
                    "y": [
                        2,
                        3,
                        5,
                        5,
                        5
                    ],
                    "name": "Voltage Divider Bias",
                    "type": "bar",
                    "marker": {
                        "color": "#2fbf8f"
                    }
                }
            ],
            "layout": {
                "xaxis": {
                    "title": ""
                },
                "yaxis": {
                    "title": "Rating (1=poor, 5=excellent)",
                    "range": [
                        0,
                        6
                    ]
                },
                "barmode": "group",
                "showlegend": true
            },
            "height": 350
        }
    ]
}