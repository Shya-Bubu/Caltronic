{
    "visuals": [
        {
            "id": "lti-eigenfunction-diagram",
            "type": "plotly",
            "title": "Complex Exponentials Are Eigenfunctions of LTI Systems",
            "description": "When e^{jkω₀t} passes through an LTI system, the output is H(jkω₀)·e^{jkω₀t}. The shape is unchanged — only scaled and phase-shifted by the transfer function.",
            "traces": [
                {
                    "x": [
                        "Input:\ne^{jkω₀t}",
                        "→ LTI System\nH(jω) →",
                        "Output:\nH(jkω₀) · e^{jkω₀t}"
                    ],
                    "y": [
                        1,
                        1,
                        1
                    ],
                    "type": "bar",
                    "marker": {
                        "color": [
                            "#4f8cff",
                            "#f5a623",
                            "#2fbf8f"
                        ]
                    },
                    "text": [
                        "Complex\nexponential",
                        "Transfer\nfunction",
                        "Same exponential\nscaled by H(jkω₀)"
                    ],
                    "textposition": "inside",
                    "textfont": {
                        "size": 10,
                        "color": "#ffffff"
                    },
                    "showlegend": false,
                    "hoverinfo": "none"
                }
            ],
            "layout": {
                "xaxis": {
                    "title": ""
                },
                "yaxis": {
                    "visible": false,
                    "range": [
                        0,
                        1.3
                    ]
                },
                "showlegend": false,
                "annotations": [
                    {
                        "x": "→ LTI System\nH(jω) →",
                        "y": 1.15,
                        "text": "Eigenfunction: shape preserved!",
                        "showarrow": false,
                        "font": {
                            "size": 12,
                            "color": "#f5a623"
                        }
                    }
                ]
            },
            "height": 300
        },
        {
            "id": "periodic-through-lti",
            "type": "plotly",
            "title": "Periodic Signal Through an LTI System",
            "description": "Each harmonic X_k·e^{jkω₀t} is independently scaled by H(jkω₀). Output coefficients: Y_k = X_k · H(jkω₀). The system processes each frequency independently.",
            "traces": [
                {
                    "x": [
                        "Input x(t)\n= Σ X_k e^{jkω₀t}",
                        "→ H(jω) →\neach k independently",
                        "Output y(t)\n= Σ Y_k e^{jkω₀t}"
                    ],
                    "y": [
                        1,
                        1,
                        1
                    ],
                    "type": "bar",
                    "marker": {
                        "color": [
                            "#4f8cff",
                            "#f5a623",
                            "#2fbf8f"
                        ]
                    },
                    "text": [
                        "Sum of\nharmonics",
                        "Y_k = X_k · H(jkω₀)\nper harmonic",
                        "Modified\nharmonics"
                    ],
                    "textposition": "inside",
                    "textfont": {
                        "size": 10,
                        "color": "#ffffff"
                    },
                    "showlegend": false,
                    "hoverinfo": "none"
                }
            ],
            "layout": {
                "xaxis": {
                    "title": ""
                },
                "yaxis": {
                    "visible": false,
                    "range": [
                        0,
                        1.3
                    ]
                },
                "showlegend": false
            },
            "height": 280
        },
        {
            "id": "lowpass-magnitude",
            "type": "plotly",
            "title": "Lowpass Filter Magnitude Response |H(jω)|",
            "description": "A lowpass filter passes low frequencies (|H| ≈ 1) and attenuates high frequencies (|H| → 0). The cutoff frequency ω_c determines the transition.",
            "traces": [
                {
                    "x_expr": "Array.from({length: 200}, (_, i) => i * 0.1)",
                    "y_expr": "Array.from({length: 200}, (_, i) => 1 / Math.sqrt(1 + Math.pow(i * 0.1 / 5, 2)))",
                    "mode": "lines",
                    "name": "|H(jω)| (1st order)",
                    "line": {
                        "color": "#4f8cff",
                        "width": 2.5
                    }
                },
                {
                    "x": [
                        5,
                        5
                    ],
                    "y": [
                        0,
                        0.707
                    ],
                    "mode": "lines",
                    "name": "ω_c (cutoff, −3dB)",
                    "line": {
                        "color": "#ff6b8a",
                        "width": 1.5,
                        "dash": "dash"
                    }
                }
            ],
            "layout": {
                "xaxis": {
                    "title": "ω (rad/s)"
                },
                "yaxis": {
                    "title": "|H(jω)|",
                    "range": [
                        0,
                        1.1
                    ]
                },
                "showlegend": true
            }
        },
        {
            "id": "square-through-lowpass",
            "type": "plotly",
            "title": "Square Wave Through a Lowpass Filter",
            "description": "The lowpass filter removes high harmonics, rounding the sharp edges. The output looks like a smoothed version of the input.",
            "traces": [
                {
                    "x_expr": "Array.from({length: 400}, (_, i) => -Math.PI + i * 2 * Math.PI / 400)",
                    "y_expr": "Array.from({length: 400}, (_, i) => { const t = -Math.PI + i * 2 * Math.PI / 400; let s = 0; for(let k=1; k<=15; k+=2) s += (4/(k*Math.PI))*Math.sin(k*t); return s; })",
                    "mode": "lines",
                    "name": "Input: square wave",
                    "line": {
                        "color": "#4f8cff",
                        "width": 1.5
                    }
                },
                {
                    "x_expr": "Array.from({length: 400}, (_, i) => -Math.PI + i * 2 * Math.PI / 400)",
                    "y_expr": "Array.from({length: 400}, (_, i) => { const t = -Math.PI + i * 2 * Math.PI / 400; let s = 0; for(let k=1; k<=15; k+=2) { const H = 1/Math.sqrt(1+k*k*0.04); s += H*(4/(k*Math.PI))*Math.sin(k*t); } return s; })",
                    "mode": "lines",
                    "name": "Output: filtered (smoothed)",
                    "line": {
                        "color": "#2fbf8f",
                        "width": 2.5
                    }
                }
            ],
            "layout": {
                "xaxis": {
                    "title": "t"
                },
                "yaxis": {
                    "title": "x(t)"
                },
                "showlegend": true
            }
        },
        {
            "id": "highpass-effect",
            "type": "plotly",
            "title": "Square Wave Through a Highpass Filter",
            "description": "A highpass filter removes the DC and low harmonics, keeping only the sharp transitions. The output shows spikes at the edges.",
            "traces": [
                {
                    "x_expr": "Array.from({length: 400}, (_, i) => -Math.PI + i * 2 * Math.PI / 400)",
                    "y_expr": "Array.from({length: 400}, (_, i) => { const t = -Math.PI + i * 2 * Math.PI / 400; let s = 0; for(let k=1; k<=15; k+=2) s += (4/(k*Math.PI))*Math.sin(k*t); return s; })",
                    "mode": "lines",
                    "name": "Input: square wave",
                    "line": {
                        "color": "#4f8cff",
                        "width": 1.5
                    }
                },
                {
                    "x_expr": "Array.from({length: 400}, (_, i) => -Math.PI + i * 2 * Math.PI / 400)",
                    "y_expr": "Array.from({length: 400}, (_, i) => { const t = -Math.PI + i * 2 * Math.PI / 400; let s = 0; for(let k=1; k<=15; k+=2) { const H = k*0.2/Math.sqrt(1+k*k*0.04); s += H*(4/(k*Math.PI))*Math.sin(k*t); } return s; })",
                    "mode": "lines",
                    "name": "Output: highpass (edges only)",
                    "line": {
                        "color": "#ff6b8a",
                        "width": 2.5
                    }
                }
            ],
            "layout": {
                "xaxis": {
                    "title": "t"
                },
                "yaxis": {
                    "title": "x(t)"
                },
                "showlegend": true
            }
        },
        {
            "id": "coeff-modification",
            "type": "plotly",
            "title": "Input vs Output Spectra: Y_k = X_k · H(jkω₀)",
            "description": "The output spectrum is the input spectrum multiplied by the filter's frequency response at each harmonic frequency.",
            "traces": [
                {
                    "x": [
                        1,
                        3,
                        5,
                        7,
                        9
                    ],
                    "y_expr": "[4/Math.PI, 4/(3*Math.PI), 4/(5*Math.PI), 4/(7*Math.PI), 4/(9*Math.PI)]",
                    "type": "bar",
                    "name": "Input |X_k|",
                    "marker": {
                        "color": "#4f8cff",
                        "opacity": 0.6
                    }
                },
                {
                    "x": [
                        1,
                        3,
                        5,
                        7,
                        9
                    ],
                    "y_expr": "[4/Math.PI*0.98, 4/(3*Math.PI)*0.86, 4/(5*Math.PI)*0.71, 4/(7*Math.PI)*0.58, 4/(9*Math.PI)*0.49]",
                    "type": "bar",
                    "name": "Output |Y_k| = |X_k|·|H(jkω₀)|",
                    "marker": {
                        "color": "#2fbf8f",
                        "opacity": 0.8
                    }
                }
            ],
            "layout": {
                "xaxis": {
                    "title": "Harmonic k",
                    "dtick": 2
                },
                "yaxis": {
                    "title": "|Coefficient|"
                },
                "barmode": "group",
                "showlegend": true
            }
        },
        {
            "id": "rc-lowpass-response",
            "type": "plotly",
            "title": "RC Lowpass Filter: Magnitude and Phase",
            "description": "H(jω) = 1/(1 + jωRC). Magnitude: 1/√(1 + (ωRC)²). Phase: −arctan(ωRC). Cutoff at ω_c = 1/RC.",
            "traces": [
                {
                    "x_expr": "Array.from({length: 200}, (_, i) => i * 0.1)",
                    "y_expr": "Array.from({length: 200}, (_, i) => 1 / Math.sqrt(1 + Math.pow(i * 0.1 / 5, 2)))",
                    "mode": "lines",
                    "name": "|H(jω)| (magnitude)",
                    "line": {
                        "color": "#4f8cff",
                        "width": 2.5
                    }
                },
                {
                    "x_expr": "Array.from({length: 200}, (_, i) => i * 0.1)",
                    "y_expr": "Array.from({length: 200}, (_, i) => -Math.atan(i * 0.1 / 5) * 180 / Math.PI)",
                    "mode": "lines",
                    "name": "∠H(jω) (degrees)",
                    "line": {
                        "color": "#ff6b8a",
                        "width": 2,
                        "dash": "dash"
                    },
                    "yaxis": "y2"
                }
            ],
            "layout": {
                "xaxis": {
                    "title": "ω (rad/s)"
                },
                "yaxis": {
                    "title": "|H(jω)|",
                    "range": [
                        0,
                        1.1
                    ]
                },
                "yaxis2": {
                    "title": "Phase (°)",
                    "overlaying": "y",
                    "side": "right",
                    "range": [
                        -100,
                        10
                    ]
                },
                "showlegend": true
            }
        },
        {
            "id": "lti-filter-sim",
            "type": "v3-waveform",
            "title": "Interactive: Pass a Signal Through a Filter",
            "description": "Choose a periodic signal and a filter type (lowpass/highpass). Watch the spectrum and time-domain output change as you adjust the cutoff frequency."
        },
        {
            "id": "eigenfunction-waveform",
            "type": "plotly",
            "title": "Eigenfunction Property: Input and Output Shape Match",
            "description": "Input: e^{j2ω₀t} (a complex exponential). Output: H(j2ω₀)·e^{j2ω₀t}. Same frequency, just scaled and phase-shifted.",
            "traces": [
                {
                    "x_expr": "Array.from({length: 300}, (_, i) => i * 2 * Math.PI / 300)",
                    "y_expr": "Array.from({length: 300}, (_, i) => Math.cos(2 * i * 2 * Math.PI / 300))",
                    "mode": "lines",
                    "name": "Input: cos(2ω₀t)",
                    "line": {
                        "color": "#4f8cff",
                        "width": 2
                    }
                },
                {
                    "x_expr": "Array.from({length: 300}, (_, i) => i * 2 * Math.PI / 300)",
                    "y_expr": "Array.from({length: 300}, (_, i) => 0.7 * Math.cos(2 * i * 2 * Math.PI / 300 - 0.5))",
                    "mode": "lines",
                    "name": "Output: |H|·cos(2ω₀t + ∠H)",
                    "line": {
                        "color": "#2fbf8f",
                        "width": 2.5
                    }
                }
            ],
            "layout": {
                "xaxis": {
                    "title": "t"
                },
                "yaxis": {
                    "title": "Amplitude"
                },
                "showlegend": true,
                "annotations": [
                    {
                        "x": 3,
                        "y": 1.1,
                        "text": "Same frequency, different amplitude & phase",
                        "showarrow": false,
                        "font": {
                            "size": 11,
                            "color": "#f5a623"
                        }
                    }
                ]
            }
        },
        {
            "id": "output-power-parseval",
            "type": "v3-waveform",
            "title": "Interactive: Output Power After Filtering",
            "description": "Apply Parseval's theorem to compute output power: P_out = Σ|Y_k|² = Σ|X_k|²·|H(jkω₀)|². Compare input and output power."
        }
    ]
}