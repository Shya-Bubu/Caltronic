{
    "visuals": [
        {
            "id": "diff-int-block-diagram",
            "type": "plotly",
            "title": "Differentiation and Integration in the FS Domain",
            "description": "Starting from signal x(t) with coefficients X_k, differentiation maps X_k → jkω₀X_k (amplifies high frequencies), while integration maps X_k → X_k/(jkω₀) (attenuates high frequencies).",
            "traces": [
                {
                    "x": [
                        "x(t)\nFS: X_k",
                        "→ d/dt →",
                        "→ ∫dt →"
                    ],
                    "y": [
                        1,
                        1,
                        1
                    ],
                    "type": "bar",
                    "marker": {
                        "color": [
                            "#4f8cff",
                            "#ff6b8a",
                            "#2fbf8f"
                        ]
                    },
                    "text": [
                        "Original\nsignal",
                        "x'(t)\njkω₀ X_k\nHighpass",
                        "∫x(t)dt\nX_k/(jkω₀)\nLowpass"
                    ],
                    "textposition": "inside",
                    "textfont": {
                        "size": 11,
                        "color": "#ffffff"
                    },
                    "showlegend": false,
                    "hoverinfo": "none"
                }
            ],
            "layout": {
                "xaxis": {
                    "title": ""
                },
                "yaxis": {
                    "visible": false,
                    "range": [
                        0,
                        1.3
                    ]
                },
                "showlegend": false,
                "annotations": [
                    {
                        "x": "→ d/dt →",
                        "y": 1.15,
                        "text": "Sharpens signal",
                        "showarrow": false,
                        "font": {
                            "size": 11,
                            "color": "#ff6b8a"
                        }
                    },
                    {
                        "x": "→ ∫dt →",
                        "y": 1.15,
                        "text": "Smooths signal",
                        "showarrow": false,
                        "font": {
                            "size": 11,
                            "color": "#2fbf8f"
                        }
                    }
                ]
            },
            "height": 280
        },
        {
            "id": "highpass-lowpass-bars",
            "type": "plotly",
            "title": "Differentiation (Highpass) vs Integration (Lowpass) Gain",
            "description": "Differentiation multiplies each harmonic by k (growing with k — amplifies high frequencies). Integration divides by k (shrinking with k — attenuates high frequencies).",
            "traces": [
                {
                    "x": [
                        1,
                        2,
                        3,
                        4,
                        5,
                        6,
                        7,
                        8,
                        9,
                        10
                    ],
                    "y": [
                        1,
                        2,
                        3,
                        4,
                        5,
                        6,
                        7,
                        8,
                        9,
                        10
                    ],
                    "type": "bar",
                    "name": "Differentiation: |jkω₀| ∝ k",
                    "marker": {
                        "color": "#ff6b8a"
                    }
                },
                {
                    "x": [
                        1,
                        2,
                        3,
                        4,
                        5,
                        6,
                        7,
                        8,
                        9,
                        10
                    ],
                    "y": [
                        1,
                        0.5,
                        0.333,
                        0.25,
                        0.2,
                        0.167,
                        0.143,
                        0.125,
                        0.111,
                        0.1
                    ],
                    "type": "bar",
                    "name": "Integration: 1/|jkω₀| ∝ 1/k",
                    "marker": {
                        "color": "#2fbf8f"
                    }
                }
            ],
            "layout": {
                "xaxis": {
                    "title": "Harmonic k",
                    "dtick": 1
                },
                "yaxis": {
                    "title": "Gain Factor"
                },
                "barmode": "group",
                "showlegend": true
            }
        },
        {
            "id": "sawtooth-original",
            "type": "plotly",
            "title": "Sawtooth Wave: A Signal to Differentiate",
            "description": "A sawtooth wave ramps linearly and then resets. Its linear ramp contains many harmonics. Differentiating it produces impulses at the jumps and a constant between them.",
            "traces": [
                {
                    "x_expr": "Array.from({length: 400}, (_, i) => i / 400 * 4)",
                    "y_expr": "Array.from({length: 400}, (_, i) => { const t = (i / 400 * 4) % 1; return 2 * t - 1; })",
                    "mode": "lines",
                    "name": "Sawtooth x(t)",
                    "line": {
                        "color": "#4f8cff",
                        "width": 2.5
                    }
                }
            ],
            "layout": {
                "xaxis": {
                    "title": "t / T₀"
                },
                "yaxis": {
                    "title": "x(t)",
                    "range": [
                        -1.3,
                        1.3
                    ]
                },
                "showlegend": true
            }
        },
        {
            "id": "differentiation-time-domain",
            "type": "plotly",
            "title": "Time Domain: Signal and Its Derivative",
            "description": "A smooth periodic signal x(t) and its derivative x'(t). The derivative is large where x(t) changes rapidly and zero where x(t) is flat.",
            "traces": [
                {
                    "x_expr": "Array.from({length: 300}, (_, i) => i * 2 * Math.PI / 300)",
                    "y_expr": "Array.from({length: 300}, (_, i) => { const t = i * 2 * Math.PI / 300; return Math.sin(t) + 0.3*Math.sin(3*t); })",
                    "mode": "lines",
                    "name": "x(t)",
                    "line": {
                        "color": "#4f8cff",
                        "width": 2.5
                    }
                },
                {
                    "x_expr": "Array.from({length: 300}, (_, i) => i * 2 * Math.PI / 300)",
                    "y_expr": "Array.from({length: 300}, (_, i) => { const t = i * 2 * Math.PI / 300; return Math.cos(t) + 0.9*Math.cos(3*t); })",
                    "mode": "lines",
                    "name": "x'(t)",
                    "line": {
                        "color": "#ff6b8a",
                        "width": 2,
                        "dash": "dash"
                    }
                }
            ],
            "layout": {
                "xaxis": {
                    "title": "t"
                },
                "yaxis": {
                    "title": "Amplitude"
                },
                "showlegend": true
            }
        },
        {
            "id": "integration-smoothing-demo",
            "type": "plotly",
            "title": "Integration Smooths: x(t) vs ∫x(t)dt",
            "description": "Integration smooths a signal by attenuating high harmonics. The integral of a square-ish signal looks triangular because sharp edges are rounded off.",
            "traces": [
                {
                    "x_expr": "Array.from({length: 300}, (_, i) => i * 2 * Math.PI / 300)",
                    "y_expr": "Array.from({length: 300}, (_, i) => { const t = i * 2 * Math.PI / 300; return Math.sin(t) + 0.5*Math.sin(3*t) + 0.2*Math.sin(5*t); })",
                    "mode": "lines",
                    "name": "x(t)",
                    "line": {
                        "color": "#4f8cff",
                        "width": 2.5
                    }
                },
                {
                    "x_expr": "Array.from({length: 300}, (_, i) => i * 2 * Math.PI / 300)",
                    "y_expr": "Array.from({length: 300}, (_, i) => { const t = i * 2 * Math.PI / 300; return -Math.cos(t) - (0.5/3)*Math.cos(3*t) - (0.2/5)*Math.cos(5*t); })",
                    "mode": "lines",
                    "name": "∫x(t)dt (smoothed)",
                    "line": {
                        "color": "#2fbf8f",
                        "width": 2,
                        "dash": "dash"
                    }
                }
            ],
            "layout": {
                "xaxis": {
                    "title": "t"
                },
                "yaxis": {
                    "title": "Amplitude"
                },
                "showlegend": true
            }
        },
        {
            "id": "spectrum-sharpening",
            "type": "plotly",
            "title": "Spectrum After Differentiation: High Harmonics Boosted",
            "description": "The original spectrum |X_k| decays. After differentiation, |jkω₀X_k| grows with k, boosting higher harmonics.",
            "traces": [
                {
                    "x": [
                        1,
                        2,
                        3,
                        4,
                        5,
                        6,
                        7
                    ],
                    "y": [
                        1,
                        0.5,
                        0.33,
                        0.25,
                        0.2,
                        0.167,
                        0.143
                    ],
                    "type": "bar",
                    "name": "|X_k| (original)",
                    "marker": {
                        "color": "#4f8cff",
                        "opacity": 0.7
                    }
                },
                {
                    "x": [
                        1,
                        2,
                        3,
                        4,
                        5,
                        6,
                        7
                    ],
                    "y": [
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1
                    ],
                    "type": "bar",
                    "name": "|jkω₀X_k| (after diff)",
                    "marker": {
                        "color": "#ff6b8a",
                        "opacity": 0.7
                    }
                }
            ],
            "layout": {
                "xaxis": {
                    "title": "Harmonic k",
                    "dtick": 1
                },
                "yaxis": {
                    "title": "|Coefficient|"
                },
                "barmode": "group",
                "showlegend": true
            }
        },
        {
            "id": "spectrum-smoothing",
            "type": "plotly",
            "title": "Spectrum After Integration: High Harmonics Attenuated",
            "description": "After integration, the coefficients |X_k/(jkω₀)| decay faster than the original. High harmonics are suppressed.",
            "traces": [
                {
                    "x": [
                        1,
                        2,
                        3,
                        4,
                        5,
                        6,
                        7
                    ],
                    "y": [
                        1,
                        0.5,
                        0.33,
                        0.25,
                        0.2,
                        0.167,
                        0.143
                    ],
                    "type": "bar",
                    "name": "|X_k| (original)",
                    "marker": {
                        "color": "#4f8cff",
                        "opacity": 0.7
                    }
                },
                {
                    "x": [
                        1,
                        2,
                        3,
                        4,
                        5,
                        6,
                        7
                    ],
                    "y": [
                        1,
                        0.25,
                        0.111,
                        0.063,
                        0.04,
                        0.028,
                        0.02
                    ],
                    "type": "bar",
                    "name": "|X_k/(jkω₀)| (after int)",
                    "marker": {
                        "color": "#2fbf8f",
                        "opacity": 0.7
                    }
                }
            ],
            "layout": {
                "xaxis": {
                    "title": "Harmonic k",
                    "dtick": 1
                },
                "yaxis": {
                    "title": "|Coefficient|"
                },
                "barmode": "group",
                "showlegend": true
            }
        },
        {
            "id": "diff-int-explorer",
            "type": "v3-waveform",
            "title": "Interactive: Differentiate and Integrate a Signal",
            "description": "Start with a composite signal and apply differentiation or integration. Watch how the harmonic amplitudes change."
        },
        {
            "id": "decay-rate-comparison",
            "type": "v3-waveform",
            "title": "Interactive: Coefficient Decay Before and After Operations",
            "description": "Compare the coefficient decay rates of a signal, its derivative, and its integral. Smoother signals have faster-decaying coefficients."
        },
        {
            "id": "phase-shift-diagram",
            "type": "plotly",
            "title": "Phase Effects: +90° per Differentiation, −90° per Integration",
            "description": "Differentiation multiplies by jk, adding +90° per operation. Integration divides by jk, adding −90°. The j factor rotates each coefficient in the complex plane.",
            "traces": [
                {
                    "x": [
                        "X_k\nOriginal phase",
                        "→ ×jkω₀ →\nDifferentiation",
                        "→ ÷jkω₀ →\nIntegration"
                    ],
                    "y": [
                        1,
                        1,
                        1
                    ],
                    "type": "bar",
                    "marker": {
                        "color": [
                            "#4f8cff",
                            "#ff6b8a",
                            "#2fbf8f"
                        ]
                    },
                    "text": [
                        "Original\nphase angle",
                        "jkω₀X_k\nPhase + 90°",
                        "X_k/(jkω₀)\nPhase − 90°"
                    ],
                    "textposition": "inside",
                    "textfont": {
                        "size": 11,
                        "color": "#ffffff"
                    },
                    "showlegend": false,
                    "hoverinfo": "none"
                }
            ],
            "layout": {
                "xaxis": {
                    "title": ""
                },
                "yaxis": {
                    "visible": false,
                    "range": [
                        0,
                        1.3
                    ]
                },
                "showlegend": false,
                "annotations": [
                    {
                        "x": "→ ×jkω₀ →\nDifferentiation",
                        "y": 1.15,
                        "text": "j = e^{jπ/2} → +90°",
                        "showarrow": false,
                        "font": {
                            "size": 11,
                            "color": "#ff6b8a"
                        }
                    },
                    {
                        "x": "→ ÷jkω₀ →\nIntegration",
                        "y": 1.15,
                        "text": "1/j = e^{-jπ/2} → −90°",
                        "showarrow": false,
                        "font": {
                            "size": 11,
                            "color": "#2fbf8f"
                        }
                    }
                ]
            },
            "height": 300
        }
    ]
}