{
    "visuals": [
        {
            "id": "linearity-demo",
            "type": "plotly",
            "title": "Linearity: Scaling and Addition in Time = Scaling and Addition in Frequency",
            "description": "If x(t) has coefficients X_k, then ax(t) + by(t) has coefficients aX_k + bY_k. The FS is a linear operation.",
            "traces": [
                {
                    "x_expr": "Array.from({length: 400}, (_, i) => i * 2 * Math.PI / 400)",
                    "y_expr": "Array.from({length: 400}, (_, i) => { const t = i * 2 * Math.PI / 400; return Math.sin(t); })",
                    "mode": "lines",
                    "name": "x(t) = sin(t)",
                    "line": {
                        "color": "#4f8cff",
                        "width": 2
                    }
                },
                {
                    "x_expr": "Array.from({length: 400}, (_, i) => i * 2 * Math.PI / 400)",
                    "y_expr": "Array.from({length: 400}, (_, i) => { const t = i * 2 * Math.PI / 400; return 0.5*Math.sin(3*t); })",
                    "mode": "lines",
                    "name": "y(t) = 0.5sin(3t)",
                    "line": {
                        "color": "#ff6b8a",
                        "width": 2
                    }
                },
                {
                    "x_expr": "Array.from({length: 400}, (_, i) => i * 2 * Math.PI / 400)",
                    "y_expr": "Array.from({length: 400}, (_, i) => { const t = i * 2 * Math.PI / 400; return Math.sin(t) + 0.5*Math.sin(3*t); })",
                    "mode": "lines",
                    "name": "x(t) + y(t)",
                    "line": {
                        "color": "#2fbf8f",
                        "width": 2.5
                    }
                }
            ],
            "layout": {
                "xaxis": {
                    "title": "t"
                },
                "yaxis": {
                    "title": "Amplitude"
                },
                "showlegend": true
            }
        },
        {
            "id": "linearity-spectrum-add",
            "type": "plotly",
            "title": "Linearity in Action: Spectra Add",
            "description": "The spectrum of x(t)+y(t) is the sum of their individual spectra. Each harmonic adds independently.",
            "traces": [
                {
                    "x": [
                        1,
                        2,
                        3,
                        4,
                        5
                    ],
                    "y": [
                        1,
                        0,
                        0,
                        0,
                        0
                    ],
                    "type": "bar",
                    "name": "|X_k| of sin(t)",
                    "marker": {
                        "color": "#4f8cff",
                        "opacity": 0.6
                    }
                },
                {
                    "x": [
                        1,
                        2,
                        3,
                        4,
                        5
                    ],
                    "y": [
                        0,
                        0,
                        0.5,
                        0,
                        0
                    ],
                    "type": "bar",
                    "name": "|Y_k| of 0.5sin(3t)",
                    "marker": {
                        "color": "#ff6b8a",
                        "opacity": 0.6
                    }
                },
                {
                    "x": [
                        1,
                        2,
                        3,
                        4,
                        5
                    ],
                    "y": [
                        1,
                        0,
                        0.5,
                        0,
                        0
                    ],
                    "type": "bar",
                    "name": "|X_k + Y_k| (sum)",
                    "marker": {
                        "color": "#2fbf8f",
                        "opacity": 0.8
                    }
                }
            ],
            "layout": {
                "xaxis": {
                    "title": "k",
                    "dtick": 1
                },
                "yaxis": {
                    "title": "|Coefficient|"
                },
                "barmode": "group",
                "showlegend": true
            }
        },
        {
            "id": "time-shift-original-vs-shifted",
            "type": "plotly",
            "title": "Time Shift: x(t) vs x(t − t₀)",
            "description": "Shifting a signal in time delays all features without changing the shape. The magnitude spectrum remains identical.",
            "traces": [
                {
                    "x_expr": "Array.from({length: 400}, (_, i) => i * 2 * Math.PI / 400)",
                    "y_expr": "Array.from({length: 400}, (_, i) => { const t = i * 2 * Math.PI / 400; return Math.sin(t) + 0.3*Math.sin(3*t); })",
                    "mode": "lines",
                    "name": "x(t)",
                    "line": {
                        "color": "#4f8cff",
                        "width": 2.5
                    }
                },
                {
                    "x_expr": "Array.from({length: 400}, (_, i) => i * 2 * Math.PI / 400)",
                    "y_expr": "Array.from({length: 400}, (_, i) => { const t = i * 2 * Math.PI / 400 - 1; return Math.sin(t) + 0.3*Math.sin(3*t); })",
                    "mode": "lines",
                    "name": "x(t − t₀) shifted",
                    "line": {
                        "color": "#ff6b8a",
                        "width": 2,
                        "dash": "dash"
                    }
                }
            ],
            "layout": {
                "xaxis": {
                    "title": "t"
                },
                "yaxis": {
                    "title": "x(t)"
                },
                "showlegend": true
            }
        },
        {
            "id": "time-shift-phase-effect",
            "type": "plotly",
            "title": "Time Shift → Phase Change: X_k → X_k · e^{−jkω₀t₀}",
            "description": "A time shift adds a linear phase −kω₀t₀ to each coefficient. Higher harmonics get more phase shift.",
            "traces": [
                {
                    "x": [
                        1,
                        2,
                        3,
                        4,
                        5,
                        6,
                        7
                    ],
                    "y_expr": "[1*0.5, 2*0.5, 3*0.5, 4*0.5, 5*0.5, 6*0.5, 7*0.5].map(v => -v)",
                    "type": "bar",
                    "name": "Phase shift −kω₀t₀ (linear in k)",
                    "marker": {
                        "color": "#ff6b8a"
                    }
                }
            ],
            "layout": {
                "xaxis": {
                    "title": "Harmonic k",
                    "dtick": 1
                },
                "yaxis": {
                    "title": "Phase shift (rad)"
                },
                "showlegend": false
            }
        },
        {
            "id": "shift-magnitude-unchanged",
            "type": "v3-waveform",
            "title": "Interactive: Shift a Signal and See the Phase Change",
            "description": "Slide the time delay t₀. Watch the magnitude spectrum stay constant while the phase spectrum tilts linearly."
        },
        {
            "id": "time-reversal-demo",
            "type": "plotly",
            "title": "Time Reversal: x(t) → x(−t) Reverses the Signal",
            "description": "Time reversal flips the signal. In the frequency domain, X_k → X_{−k}: the coefficients reverse their index.",
            "traces": [
                {
                    "x_expr": "Array.from({length: 400}, (_, i) => -Math.PI + i * 2 * Math.PI / 400)",
                    "y_expr": "Array.from({length: 400}, (_, i) => { const t = -Math.PI + i * 2 * Math.PI / 400; return Math.sin(t) + 0.4*Math.sin(2*t); })",
                    "mode": "lines",
                    "name": "x(t)",
                    "line": {
                        "color": "#4f8cff",
                        "width": 2.5
                    }
                },
                {
                    "x_expr": "Array.from({length: 400}, (_, i) => -Math.PI + i * 2 * Math.PI / 400)",
                    "y_expr": "Array.from({length: 400}, (_, i) => { const t = -Math.PI + i * 2 * Math.PI / 400; return -Math.sin(t) - 0.4*Math.sin(2*t); })",
                    "mode": "lines",
                    "name": "x(−t) (reversed)",
                    "line": {
                        "color": "#2fbf8f",
                        "width": 2,
                        "dash": "dash"
                    }
                }
            ],
            "layout": {
                "xaxis": {
                    "title": "t"
                },
                "yaxis": {
                    "title": "Amplitude"
                },
                "showlegend": true
            }
        },
        {
            "id": "time-scaling-compression",
            "type": "plotly",
            "title": "Time Scaling: x(at) Compresses in Time, Expands in Frequency",
            "description": "Compressing a signal by factor a in time expands its spectrum. The new period is T₀/a and ω₀ becomes aω₀.",
            "traces": [
                {
                    "x_expr": "Array.from({length: 400}, (_, i) => i * 4 * Math.PI / 400)",
                    "y_expr": "Array.from({length: 400}, (_, i) => { const t = i * 4 * Math.PI / 400; return Math.sin(t) + 0.3*Math.sin(3*t); })",
                    "mode": "lines",
                    "name": "x(t) (original)",
                    "line": {
                        "color": "#4f8cff",
                        "width": 2
                    }
                },
                {
                    "x_expr": "Array.from({length: 400}, (_, i) => i * 4 * Math.PI / 400)",
                    "y_expr": "Array.from({length: 400}, (_, i) => { const t = i * 4 * Math.PI / 400; return Math.sin(2*t) + 0.3*Math.sin(6*t); })",
                    "mode": "lines",
                    "name": "x(2t) (compressed)",
                    "line": {
                        "color": "#ff6b8a",
                        "width": 2,
                        "dash": "dash"
                    }
                }
            ],
            "layout": {
                "xaxis": {
                    "title": "t"
                },
                "yaxis": {
                    "title": "x(t)"
                },
                "showlegend": true
            }
        },
        {
            "id": "time-scaling-freq-axis",
            "type": "plotly",
            "title": "Time Scaling Effect on Frequency Axis",
            "description": "Compressing by a=2 doubles the fundamental frequency. Harmonics spread further apart on the frequency axis.",
            "traces": [
                {
                    "x": [
                        "ω₀",
                        "2ω₀",
                        "3ω₀",
                        "4ω₀",
                        "5ω₀"
                    ],
                    "y": [
                        1,
                        0,
                        0.3,
                        0,
                        0
                    ],
                    "type": "bar",
                    "name": "x(t): ω₀ spacing",
                    "marker": {
                        "color": "#4f8cff",
                        "opacity": 0.6
                    }
                },
                {
                    "x": [
                        "ω₀",
                        "2ω₀",
                        "3ω₀",
                        "4ω₀",
                        "5ω₀"
                    ],
                    "y": [
                        0,
                        1,
                        0,
                        0,
                        0
                    ],
                    "type": "bar",
                    "name": "x(2t): 2ω₀ spacing",
                    "marker": {
                        "color": "#ff6b8a",
                        "opacity": 0.6
                    }
                }
            ],
            "layout": {
                "xaxis": {
                    "title": "Frequency"
                },
                "yaxis": {
                    "title": "|Coefficient|"
                },
                "barmode": "group",
                "showlegend": true
            }
        },
        {
            "id": "properties-summary-diagram",
            "type": "plotly",
            "title": "Summary: Key Fourier Series Properties",
            "description": "Linearity, time shift, time reversal, and time scaling — the four essential FS properties.",
            "traces": [
                {
                    "x": [
                        "Linearity\nax+by → aX_k+bY_k",
                        "Time Shift\nx(t−t₀) → e^{−jkω₀t₀}X_k",
                        "Time Reversal\nx(−t) → X_{−k}",
                        "Time Scaling\nx(at) → new ω₀=aω₀"
                    ],
                    "y": [
                        1,
                        1,
                        1,
                        1
                    ],
                    "type": "bar",
                    "marker": {
                        "color": [
                            "#4f8cff",
                            "#ff6b8a",
                            "#6b62ff",
                            "#2fbf8f"
                        ]
                    },
                    "text": [
                        "Coefficients\nadd/scale",
                        "Phase shift\n−kω₀t₀",
                        "Index\nreversal",
                        "Frequency\nexpansion"
                    ],
                    "textposition": "inside",
                    "textfont": {
                        "size": 10,
                        "color": "#ffffff"
                    },
                    "showlegend": false,
                    "hoverinfo": "none"
                }
            ],
            "layout": {
                "xaxis": {
                    "title": ""
                },
                "yaxis": {
                    "visible": false,
                    "range": [
                        0,
                        1.3
                    ]
                },
                "showlegend": false
            },
            "height": 300
        },
        {
            "id": "properties-walk-through-sim",
            "type": "v3-waveform",
            "title": "Interactive: Apply Properties Step by Step",
            "description": "Choose a property (shift, scale, reverse) and apply it to a signal. Watch both time and frequency domains update."
        }
    ]
}